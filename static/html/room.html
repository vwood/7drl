{% extends "base.html" %}

{% block nav %}
{% endblock %}

{% block content %}
<div class="title">
  <h2>{{ room.title }}</h2>
</div>

<div class="mainpanel">
  <div class="leftpanel">
	<h3>{{ player.name }}</h3>
	<img src="/images/player.png"/>
	<h4>Health: <a class="healthbar">{{ player.health }}</a></h4>
	<h4>Xp: <a class="xpbar">{{ player.score }}</a></h4>
  </div>

  <div class="rightpanel">
	{% for item in items %}
	<div>
	  <img name="replace_{{ item.image }}" src="/images/blank.png" class="imgalign"/> {{ item.name }}
	</div>
	{% endfor %}

	<div>
	{% for msg in room.messages %}
    <p>{{ msg }}</p>
    {% endfor %}
    </div>
  </div>

  <table class="room">
  {% for cell in room.tiles %}
  {% if forloop.counter0|divisibleby:room.width %}
  <tr>
  {% endif %}
  <td>
    <a name="{{ forloop.counter0 }}_exit">
	  <img src="/images/blank.png" name="{{ forloop.counter0 }}" />
    </a>
  </td>
  {% if forloop.counter|divisibleby:room.width %}
  </tr>
  {% endif %}
  {% endfor %}
  </table>
</div>

{% if room.exits|length > 0 %}
<div class="exits">
  {% for exit in room.exits %}
  <a href="/room?name={{ exit }}">{{ exit }}</a> <br />
  {% endfor %}
</div>
{% endif %}

<script type="text/javascript">
  var width = {{ room.width }};
  var tiles = [{{ room.tiles|join:"," }}];
  var free_space = [{{ room.free_space|join:"," }}];
  var items = [ {% for item in items %} {{ item.image }} {% if not forloop.last %}, {% endif %} {% endfor %} ];
  var exits = [ "{{ room.exits|join:"\", \"" }}" ];
</script>
<script type="text/javascript" src="js/simple_room.js"> </script>

{% endblock %}
